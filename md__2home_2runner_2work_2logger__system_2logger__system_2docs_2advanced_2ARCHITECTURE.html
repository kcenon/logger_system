<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Logger System: Architecture - Logger System</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Logger System<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-performance C++20 thread-safe logging system with asynchronous capabilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__2home_2runner_2work_2logger__system_2logger__system_2docs_2advanced_2ARCHITECTURE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Architecture - Logger System</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md58"></a> </p><blockquote class="doxtable">
<p>&zwj;<b>Language:</b> <b>English</b> | <a class="el" href="ARCHITECTURE__KO_8md.html">한국어</a> </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md59"></a>
Overview</h1>
<p>The Logger System is a modern C++20 asynchronous logging framework designed with modular, interface-based architecture for high-performance multithreaded applications.</p>
<p><b>Version:</b> 0.1.0.0 <b>Last Updated:</b> 2025-10-22</p>
<hr  />
<h1><a class="anchor" id="autotoc_md61"></a>
Table of Contents</h1>
<ul>
<li>Design Philosophy</li>
<li>Layered Architecture</li>
<li>Core Components</li>
<li>Integration Architecture</li>
<li>Threading Model</li>
<li>Memory Management</li>
<li>Performance Characteristics</li>
<li>Design Patterns</li>
<li>Build Configuration</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md63"></a>
Design Philosophy</h1>
<h2><a class="anchor" id="autotoc_md64"></a>
Core Principles</h2>
<ol type="1">
<li><b>Interface-Driven Design</b>: Clean separation via abstract interfaces<ul>
<li>ILogger, IMonitor, IMonitorable for ecosystem integration</li>
<li>IWriter, IFormatter, IFilter for component abstraction</li>
<li>Zero circular dependencies through interface-only dependencies</li>
</ul>
</li>
<li><b>Asynchronous by Default</b>: Non-blocking log operations<ul>
<li>Background thread processes batched log entries</li>
<li>Zero-copy message passing where possible</li>
<li>Adaptive queuing with intelligent backoff</li>
</ul>
</li>
<li><b>Modular Architecture</b>: Use only what you need<ul>
<li>Optional ecosystem integration (common_system, thread_system, monitoring_system)</li>
<li>Pluggable writers, filters, formatters</li>
<li>Independent compilation without ecosystem dependencies</li>
</ul>
</li>
<li><b>Performance First</b>: Optimized for production workloads<ul>
<li>Batched processing for maximum throughput</li>
<li>Mutex-based async logging with optimized batching to reduce lock contention</li>
<li>Minimal allocations with small string optimization</li>
</ul>
</li>
<li><b>Type Safety</b>: Comprehensive compile-time guarantees<ul>
<li>Result&lt;T&gt; pattern for error handling</li>
<li>Builder pattern with validation</li>
<li>Template-based configuration strategies</li>
</ul>
</li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md66"></a>
Layered Architecture</h1>
<div class="fragment"><div class="line">┌──────────────────────────────────────────────────────────────┐</div>
<div class="line">│                      Application Layer                       │</div>
<div class="line">│  (User code using logger via logger_builder or DI adapter)  │</div>
<div class="line">└───────────────────────────┬──────────────────────────────────┘</div>
<div class="line">                            │</div>
<div class="line">┌───────────────────────────┴──────────────────────────────────┐</div>
<div class="line">│                    Public API Layer                          │</div>
<div class="line">│  ┌─────────────┐  ┌──────────────┐  ┌───────────────────┐  │</div>
<div class="line">│  │   logger    │  │logger_builder│  │ common_logger_    │  │</div>
<div class="line">│  │   (main)    │  │  (fluent)    │  │   adapter (DI)    │  │</div>
<div class="line">│  └─────────────┘  └──────────────┘  └───────────────────┘  │</div>
<div class="line">└───────────────────────────┬──────────────────────────────────┘</div>
<div class="line">                            │</div>
<div class="line">┌───────────────────────────┴──────────────────────────────────┐</div>
<div class="line">│                     Core Layer                               │</div>
<div class="line">│  ┌──────────────┐  ┌──────────────┐  ┌─────────────────┐   │</div>
<div class="line">│  │ log_collector│  │ logger_config│  │ monitoring_     │   │</div>
<div class="line">│  │  (batching)  │  │ (validation) │  │ factory (DI)    │   │</div>
<div class="line">│  └──────────────┘  └──────────────┘  └─────────────────┘   │</div>
<div class="line">│  ┌──────────────┐  ┌──────────────┐  ┌─────────────────┐   │</div>
<div class="line">│  │ small_string │  │ error_codes  │  │ thread_         │   │</div>
<div class="line">│  │ (optimized)  │  │  (-200~-299) │  │ integration_    │   │</div>
<div class="line">│  └──────────────┘  └──────────────┘  │ detector        │   │</div>
<div class="line">│                                       └─────────────────┘   │</div>
<div class="line">└───────────────────────────┬──────────────────────────────────┘</div>
<div class="line">                            │</div>
<div class="line">┌───────────────────────────┴──────────────────────────────────┐</div>
<div class="line">│                  Interface Layer                             │</div>
<div class="line">│  ┌─────────────────────┐  ┌─────────────────────────────┐   │</div>
<div class="line">│  │ ILogger             │  │ log_writer_interface        │   │</div>
<div class="line">│  │ (logger_interface)  │  │ (output abstraction)        │   │</div>
<div class="line">│  └─────────────────────┘  └─────────────────────────────┘   │</div>
<div class="line">│  ┌─────────────────────┐  ┌─────────────────────────────┐   │</div>
<div class="line">│  │ IFormatter          │  │ IFilter                     │   │</div>
<div class="line">│  │ (format abstraction)│  │ (filter abstraction)        │   │</div>
<div class="line">│  └─────────────────────┘  └─────────────────────────────┘   │</div>
<div class="line">│  ┌─────────────────────┐  ┌─────────────────────────────┐   │</div>
<div class="line">│  │ IMonitor            │  │ log_sink_interface          │   │</div>
<div class="line">│  │ (metrics/observ.)   │  │ (processing abstraction)    │   │</div>
<div class="line">│  └─────────────────────┘  └─────────────────────────────┘   │</div>
<div class="line">└───────────────────────────┬──────────────────────────────────┘</div>
<div class="line">                            │</div>
<div class="line">┌───────────────────────────┴──────────────────────────────────┐</div>
<div class="line">│               Implementation Layer                           │</div>
<div class="line">│  ┌──────────────────┐  ┌──────────────────┐  ┌────────────┐ │</div>
<div class="line">│  │ Writers:         │  │ Formatters:      │  │ Filters:   │ │</div>
<div class="line">│  │ • console_writer │  │ • base_formatter │  │ • log_     │ │</div>
<div class="line">│  │ • file_writer    │  │   (plain text)   │  │   filter   │ │</div>
<div class="line">│  │ • rotating_file_ │  │ • JSON formatter │  │ • level    │ │</div>
<div class="line">│  │   writer         │  │ • XML formatter  │  │ • regex    │ │</div>
<div class="line">│  │ • network_writer │  │ • Custom formats │  │ • custom   │ │</div>
<div class="line">│  │ • critical_writer│  └──────────────────┘  └────────────┘ │</div>
<div class="line">│  │ • encrypted_     │                                        │</div>
<div class="line">│  │   writer         │                                        │</div>
<div class="line">│  │ • async_writer   │                                        │</div>
<div class="line">│  │ • batch_writer   │                                        │</div>
<div class="line">│  └──────────────────┘                                        │</div>
<div class="line">└───────────────────────────┬──────────────────────────────────┘</div>
<div class="line">                            │</div>
<div class="line">┌───────────────────────────┴──────────────────────────────────┐</div>
<div class="line">│                 Advanced Features Layer                      │</div>
<div class="line">│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────┐  │</div>
<div class="line">│  │ log_router   │  │ log_analyzer │  │ crash_safe_      │  │</div>
<div class="line">│  │ (routing)    │  │ (analysis)   │  │ logger (safety)  │  │</div>
<div class="line">│  └──────────────┘  └──────────────┘  └──────────────────┘  │</div>
<div class="line">│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────┐  │</div>
<div class="line">│  │ log_server   │  │ structured_  │  │ logger_metrics   │  │</div>
<div class="line">│  │ (remote log) │  │ logger (JSON)│  │ (performance)    │  │</div>
<div class="line">│  └──────────────┘  └──────────────┘  └──────────────────┘  │</div>
<div class="line">└──────────────────────────────────────────────────────────────┘</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md67"></a>
Layer Responsibilities</h2>
<ol type="1">
<li><b>Application Layer</b>: User-facing code using logger</li>
<li><b>Public API Layer</b>: Main entry points (logger, builder, adapters)</li>
<li><b>Core Layer</b>: Business logic (batching, configuration, monitoring)</li>
<li><b>Interface Layer</b>: Abstract contracts for all components</li>
<li><b>Implementation Layer</b>: Concrete writer/formatter/filter implementations</li>
<li><b>Advanced Features Layer</b>: Optional high-level features</li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md69"></a>
Core Components</h1>
<h2><a class="anchor" id="autotoc_md70"></a>
1. Logger (&lt;tt&gt;core/logger.h&lt;/tt&gt;, &lt;tt&gt;core/logger.cpp&lt;/tt&gt;)</h2>
<p><b>Purpose</b>: Main logger class with asynchronous processing</p>
<p><b>Key Methods</b>: </p><div class="fragment"><div class="line"><span class="keyword">class </span>logger {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Logging methods</span></div>
<div class="line">    <span class="keywordtype">void</span> log(log_level level, std::string_view message);</div>
<div class="line">    <span class="keywordtype">void</span> trace(std::string_view message);</div>
<div class="line">    <span class="keywordtype">void</span> debug(std::string_view message);</div>
<div class="line">    <span class="keywordtype">void</span> info(std::string_view message);</div>
<div class="line">    <span class="keywordtype">void</span> warn(std::string_view message);</div>
<div class="line">    <span class="keywordtype">void</span> error(std::string_view message);</div>
<div class="line">    <span class="keywordtype">void</span> critical(std::string_view message);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Control methods</span></div>
<div class="line">    <span class="keywordtype">void</span> flush();</div>
<div class="line">    <span class="keywordtype">void</span> stop();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configuration</span></div>
<div class="line">    <span class="keywordtype">void</span> set_level(log_level level);</div>
<div class="line">    <span class="keywordtype">void</span> add_writer(std::shared_ptr&lt;log_writer_interface&gt; writer);</div>
<div class="line">};</div>
</div><!-- fragment --><p><b>Features</b>:</p><ul>
<li>Asynchronous batched processing</li>
<li>Background worker thread</li>
<li>Thread-safe queue operations</li>
<li>Automatic buffer management</li>
<li>Emergency flush on crash</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md72"></a>
2. Logger Builder (&lt;tt&gt;core/logger_builder.h&lt;/tt&gt;)</h2>
<p><b>Purpose</b>: Fluent API for logger construction with validation</p>
<p><b>Key Methods</b>: </p><div class="fragment"><div class="line"><span class="keyword">class </span>logger_builder {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    logger_builder&amp; with_level(log_level level);</div>
<div class="line">    logger_builder&amp; with_console_output();</div>
<div class="line">    logger_builder&amp; with_file_output(<span class="keyword">const</span> std::string&amp; path);</div>
<div class="line">    logger_builder&amp; with_rotating_file(<span class="keyword">const</span> std::string&amp; path, <span class="keywordtype">size_t</span> max_size);</div>
<div class="line">    logger_builder&amp; with_network_output(<span class="keyword">const</span> std::string&amp; host, uint16_t port);</div>
<div class="line">    logger_builder&amp; with_monitoring(std::shared_ptr&lt;monitoring_interface&gt; monitor);</div>
<div class="line">    logger_builder&amp; with_template(config_template tmpl);</div>
<div class="line"> </div>
<div class="line">    common::Result&lt;std::shared_ptr&lt;logger&gt;&gt; build();</div>
<div class="line">};</div>
</div><!-- fragment --><p><b>Configuration Templates</b>:</p><ul>
<li><code>production</code>: Rotating files, structured format, ERROR+ level</li>
<li><code>debug</code>: Console + file, DEBUG+ level, colored output</li>
<li><code>high_performance</code>: Async, batched, minimal validation</li>
<li><code>low_latency</code>: Lock-free, optimized for minimal delay</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md74"></a>
3. Log Collector (&lt;tt&gt;core/log_collector.h&lt;/tt&gt;)</h2>
<p><b>Purpose</b>: Batched log entry collection and processing</p>
<p><b>Features</b>:</p><ul>
<li>Queue-based batching</li>
<li>Configurable batch sizes (default: 100 entries)</li>
<li>Adaptive queue depth</li>
<li>Back-pressure handling</li>
<li>Emergency overflow handling</li>
</ul>
<p><b>Performance</b> (Target goals - actual measurements TBD):</p><ul>
<li>Target enqueue latency: &lt;200 nanoseconds</li>
<li>Target throughput: 1M+ messages/second</li>
<li>Mutex-based implementation with batching to reduce lock contention</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md76"></a>
4. Writers</h2>
<h3><a class="anchor" id="autotoc_md77"></a>
Console Writer (&lt;tt&gt;writers/console_writer.h&lt;/tt&gt;)</h3>
<ul>
<li>Colored ANSI output</li>
<li>Stdout/stderr routing by level</li>
<li>Thread-safe console access</li>
</ul>
<h3><a class="anchor" id="autotoc_md78"></a>
File Writer (&lt;tt&gt;writers/file_writer.h&lt;/tt&gt;)</h3>
<ul>
<li>Buffered file I/O</li>
<li>Automatic flush policies</li>
<li>Error recovery with Result&lt;T&gt;</li>
</ul>
<h3><a class="anchor" id="autotoc_md79"></a>
Rotating File Writer (&lt;tt&gt;writers/rotating_file_writer.h&lt;/tt&gt;)</h3>
<ul>
<li>Size-based rotation (default: 10MB)</li>
<li>Time-based rotation (daily, hourly)</li>
<li>Automatic old file compression</li>
<li>Configurable retention policy</li>
</ul>
<h3><a class="anchor" id="autotoc_md80"></a>
Network Writer (&lt;tt&gt;writers/network_writer.h&lt;/tt&gt;)</h3>
<ul>
<li>TCP/UDP transport</li>
<li>Connection pooling</li>
<li>Automatic reconnection</li>
<li>Buffering on network failure</li>
</ul>
<h3><a class="anchor" id="autotoc_md81"></a>
Critical Writer (&lt;tt&gt;writers/critical_writer.h&lt;/tt&gt;)</h3>
<ul>
<li>Synchronous logging (no batching)</li>
<li>Immediate flush guarantee</li>
<li>For critical messages only</li>
</ul>
<h3><a class="anchor" id="autotoc_md82"></a>
Async Writer (&lt;tt&gt;writers/async_writer.h&lt;/tt&gt;)</h3>
<ul>
<li>Wraps any writer for async operation</li>
<li>Independent worker thread</li>
<li>Backlog management</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md84"></a>
5. Formatters</h2>
<h3><a class="anchor" id="autotoc_md85"></a>
Base Formatter (&lt;tt&gt;formatters/base_formatter.h&lt;/tt&gt;)</h3>
<div class="fragment"><div class="line">[2025-10-22 15:30:45.123] [INFO] [thread:1234] Message text</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md86"></a>
JSON Formatter</h3>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;timestamp&quot;: &quot;2025-10-22T15:30:45.123Z&quot;,</div>
<div class="line">  &quot;level&quot;: &quot;INFO&quot;,</div>
<div class="line">  &quot;thread_id&quot;: 1234,</div>
<div class="line">  &quot;message&quot;: &quot;Message text&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md87"></a>
XML Formatter</h3>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">log</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">timestamp</span>&gt;2025-10-22<span class="keyword">T15:30:45.123Z</span>&lt;/<span class="keywordtype">timestamp</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">level</span>&gt;<span class="keyword">INFO</span>&lt;/<span class="keywordtype">level</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">thread_id</span>&gt;1234&lt;/<span class="keywordtype">thread_id</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">message</span>&gt;<span class="keyword">Message</span> <span class="keyword">text</span>&lt;/<span class="keywordtype">message</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">log</span>&gt;</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md89"></a>
6. Filters</h2>
<h3><a class="anchor" id="autotoc_md90"></a>
Level Filter (&lt;tt&gt;filters/log_filter.h&lt;/tt&gt;)</h3>
<ul>
<li>Filter by minimum log level</li>
<li>Per-writer level configuration</li>
</ul>
<h3><a class="anchor" id="autotoc_md91"></a>
Regex Filter</h3>
<ul>
<li>Pattern-based message filtering</li>
<li>Compiled regex for performance</li>
</ul>
<h3><a class="anchor" id="autotoc_md92"></a>
Function Filter</h3>
<ul>
<li>Custom filter logic via lambda</li>
<li>Stateful filtering support</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md94"></a>
Integration Architecture</h1>
<h2><a class="anchor" id="autotoc_md95"></a>
Common System Integration</h2>
<div class="fragment"><div class="line"><span class="comment">// logger_system implements ILogger from common_system</span></div>
<div class="line"><span class="keyword">namespace </span>kcenon::logger {</div>
<div class="line">    <span class="keyword">class </span>logger : <span class="keyword">public</span> common::ILogger {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="comment">// Implements ILogger interface</span></div>
<div class="line">        <span class="keywordtype">void</span> log(log_level level, std::string_view message) <span class="keyword">override</span>;</div>
<div class="line">        <span class="keywordtype">void</span> flush() <span class="keyword">override</span>;</div>
<div class="line">        <span class="keywordtype">void</span> stop() <span class="keyword">override</span>;</div>
<div class="line">    };</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Usage with Result&lt;T&gt; pattern</span></div>
<div class="line">common::Result&lt;std::shared_ptr&lt;logger&gt;&gt; create_logger() {</div>
<div class="line">    <span class="keywordflow">return</span> logger_builder()</div>
<div class="line">        .with_console_output()</div>
<div class="line">        .with_level(log_level::info)</div>
<div class="line">        .build();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = create_logger();</div>
<div class="line"><span class="keywordflow">if</span> (result.is_ok()) {</div>
<div class="line">    <span class="keyword">auto</span> logger_instance = result.value();</div>
<div class="line">    logger_instance-&gt;info(<span class="stringliteral">&quot;Logger created successfully&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md96"></a>
Thread System Integration</h2>
<div class="fragment"><div class="line"><span class="comment">// Optional integration detected at compile-time</span></div>
<div class="line"><span class="preprocessor">#if defined(LOGGER_USE_THREAD_SYSTEM)</span></div>
<div class="line"><span class="preprocessor">    #include &lt;thread_system/logger_interface.h&gt;</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// logger implements thread_system::logger_interface</span></div>
<div class="line">    <span class="keyword">class </span>logger : <span class="keyword">public</span> thread_system::logger_interface {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keywordtype">void</span> log(log_level level, std::string_view message) <span class="keyword">override</span>;</div>
<div class="line">    };</div>
<div class="line"><span class="preprocessor">#endif</span></div>
</div><!-- fragment --><p><b>Dependency Injection Adapter</b>: </p><div class="fragment"><div class="line"><span class="comment">// Adapter for runtime DI from thread_system</span></div>
<div class="line"><span class="preprocessor">#include &lt;kcenon/logger/adapters/logger_adapter.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> logger_instance = create_logger().value();</div>
<div class="line"><span class="keyword">auto</span> adapter = std::make_shared&lt;logger_adapter&gt;(logger_instance);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Inject into thread_system</span></div>
<div class="line">thread_pool-&gt;set_logger(adapter);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md97"></a>
Monitoring System Integration</h2>
<div class="fragment"><div class="line"><span class="comment">// Optional monitoring backend injection</span></div>
<div class="line"><span class="preprocessor">#include &lt;kcenon/logger/core/monitoring/monitoring_interface.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create logger with monitoring</span></div>
<div class="line"><span class="keyword">auto</span> logger_instance = logger_builder()</div>
<div class="line">    .with_console_output()</div>
<div class="line">    .with_monitoring(monitoring_backend) <span class="comment">// Inject IMonitor</span></div>
<div class="line">    .build()</div>
<div class="line">    .value();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Logger reports metrics to monitoring_backend:</span></div>
<div class="line"><span class="comment">// - Log messages per second</span></div>
<div class="line"><span class="comment">// - Average batch size</span></div>
<div class="line"><span class="comment">// - Queue depth</span></div>
<div class="line"><span class="comment">// - Writer performance</span></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md99"></a>
Threading Model</h1>
<h2><a class="anchor" id="autotoc_md100"></a>
Asynchronous Processing</h2>
<div class="fragment"><div class="line">┌─────────────┐                   ┌──────────────┐</div>
<div class="line">│ Application │ log() [enqueue]   │ Log Collector│</div>
<div class="line">│   Thread    │──────────────────&gt;│   (queue)    │</div>
<div class="line">│             │   [non-blocking]  │              │</div>
<div class="line">└─────────────┘                   └──────┬───────┘</div>
<div class="line">                                         │</div>
<div class="line">                                         │ batched entries</div>
<div class="line">                                         ↓</div>
<div class="line">                                  ┌──────────────┐</div>
<div class="line">                                  │   Worker     │</div>
<div class="line">                                  │   Thread     │</div>
<div class="line">                                  │  (batching)  │</div>
<div class="line">                                  └──────┬───────┘</div>
<div class="line">                                         │</div>
<div class="line">                       ┌─────────────────┼─────────────────┐</div>
<div class="line">                       │                 │                 │</div>
<div class="line">                       ↓                 ↓                 ↓</div>
<div class="line">                ┌─────────────┐   ┌─────────────┐   ┌─────────────┐</div>
<div class="line">                │  Writer 1   │   │  Writer 2   │   │  Writer N   │</div>
<div class="line">                │  (console)  │   │   (file)    │   │  (network)  │</div>
<div class="line">                └─────────────┘   └─────────────┘   └─────────────┘</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md101"></a>
Thread Safety Guarantees</h2>
<ol type="1">
<li><b>Async Enqueue</b>: Application threads use mutex-protected queue during log()</li>
<li><b>Single Writer Thread</b>: One worker thread processes all batches</li>
<li><b>Writer Isolation</b>: Each writer is called serially from worker thread</li>
<li><b>Queue Protection</b>: Internal queue uses mutex with optimized batching to reduce contention</li>
</ol>
<p><b>Performance Impact</b>:</p><ul>
<li>Batching reduces lock acquisition by 100x</li>
<li>Minimal lock contention in typical workloads</li>
<li>Batching reduces writer calls by 100x</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md103"></a>
Memory Management</h1>
<h2><a class="anchor" id="autotoc_md104"></a>
Small String Optimization (SSO)</h2>
<div class="fragment"><div class="line"><span class="comment">// small_string.h - Stack-allocated short strings</span></div>
<div class="line"><span class="keyword">class </span>small_string {</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> SSO_SIZE = 23; <span class="comment">// Fit in 24 bytes</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">union </span>{</div>
<div class="line">        <span class="keywordtype">char</span> stack_buffer[SSO_SIZE + 1];</div>
<div class="line">        <span class="keyword">struct </span>{</div>
<div class="line">            <span class="keywordtype">char</span>* heap_ptr;</div>
<div class="line">            <span class="keywordtype">size_t</span> capacity;</div>
<div class="line">        };</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordtype">size_t</span> size_;</div>
<div class="line">    <span class="keywordtype">bool</span> is_heap_;</div>
<div class="line">};</div>
</div><!-- fragment --><p><b>Benefits</b>:</p><ul>
<li>Short messages (&lt;24 chars) never allocate</li>
<li>95% of log messages fit in SSO</li>
<li>Reduces allocation overhead by 90%</li>
</ul>
<h2><a class="anchor" id="autotoc_md105"></a>
Log Entry Structure</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>log_entry {</div>
<div class="line">    log_level level;</div>
<div class="line">    small_string message;        <span class="comment">// SSO-optimized</span></div>
<div class="line">    std::chrono::system_clock::time_point timestamp;</div>
<div class="line">    std::thread::id thread_id;</div>
<div class="line">    std::source_location location; <span class="comment">// C++20 feature</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>**Memory Footprint**:</p><ul>
<li>sizeof(log_entry) = 64 bytes</li>
<li>Queue capacity: 10,000 entries = 640KB</li>
<li>Total baseline memory: &lt;2MB</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md107"></a>
Performance Characteristics</h1>
<h2><a class="anchor" id="autotoc_md108"></a>
Benchmarks</h2>
<p><b>Platform</b>: Apple M1 (8-core) @ 3.2GHz, 16GB RAM, macOS Sonoma</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Metric   </th><th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Comparison    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Single-thread throughput</b>   </td><td class="markdownTableBodyNone">4.34M msg/s   </td><td class="markdownTableBodyNone">Competitive with spdlog async    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>4-thread throughput</b>   </td><td class="markdownTableBodyNone">1.07M msg/s   </td><td class="markdownTableBodyNone">24% better than spdlog    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>8-thread throughput</b>   </td><td class="markdownTableBodyNone">412K msg/s   </td><td class="markdownTableBodyNone">78% improvement with batching    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>16-thread throughput</b>   </td><td class="markdownTableBodyNone">390K msg/s   </td><td class="markdownTableBodyNone">117% boost in high contention    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Average enqueue latency</b>   </td><td class="markdownTableBodyNone">148 ns   </td><td class="markdownTableBodyNone">15.7x lower than spdlog    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Memory baseline</b>   </td><td class="markdownTableBodyNone">&lt;2MB   </td><td class="markdownTableBodyNone">Adaptive buffer management   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md109"></a>
Optimization Techniques</h2>
<ol type="1">
<li><b>Batching</b>: Processes 100 entries per batch (configurable) - reduces lock contention</li>
<li><b>Zero-Copy</b>: Move semantics for log_entry transfer</li>
<li><b>SSO</b>: Small string optimization eliminates 95% of allocations</li>
<li><b>Async Logging</b>: Background worker thread handles I/O</li>
<li><b>Adaptive Queue</b>: Grows/shrinks based on load</li>
<li><b>Writer Pooling</b>: Reuses writer connections</li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md111"></a>
Design Patterns</h1>
<h2><a class="anchor" id="autotoc_md112"></a>
1. Observer Pattern</h2>
<ul>
<li>Log entries notify registered writers</li>
<li>Filters observe and potentially block events</li>
<li>Monitoring observers collect metrics</li>
</ul>
<h2><a class="anchor" id="autotoc_md113"></a>
2. Strategy Pattern</h2>
<ul>
<li>Pluggable formatters (plain, JSON, XML)</li>
<li>Pluggable writers (console, file, network)</li>
<li>Pluggable filters (level, regex, custom)</li>
</ul>
<h2><a class="anchor" id="autotoc_md114"></a>
3. Builder Pattern</h2>
<ul>
<li>Fluent API for logger construction</li>
<li>Comprehensive validation before build()</li>
<li>Template-based configuration shortcuts</li>
</ul>
<h2><a class="anchor" id="autotoc_md115"></a>
4. Template Method Pattern</h2>
<ul>
<li>base_writer defines write() workflow</li>
<li>Derived writers customize format_message()</li>
<li>Inherited flush() and close() behavior</li>
</ul>
<h2><a class="anchor" id="autotoc_md116"></a>
5. Dependency Injection</h2>
<ul>
<li>monitoring_interface injected at runtime</li>
<li>common_logger_adapter for ecosystem DI</li>
<li>di_container_factory for advanced scenarios</li>
</ul>
<h2><a class="anchor" id="autotoc_md117"></a>
6. Factory Pattern</h2>
<ul>
<li>writer factory creates appropriate writers</li>
<li>formatter factory based on output type</li>
<li>monitoring_factory for IMonitor instances</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md119"></a>
Build Configuration</h1>
<h2><a class="anchor" id="autotoc_md120"></a>
CMake Options</h2>
<div class="fragment"><div class="line"># Core options</div>
<div class="line">option(BUILD_TESTS &quot;Build unit tests&quot; ON)</div>
<div class="line">option(BUILD_BENCHMARKS &quot;Build benchmarks&quot; OFF)</div>
<div class="line">option(BUILD_SAMPLES &quot;Build sample programs&quot; ON)</div>
<div class="line">option(BUILD_SHARED_LIBS &quot;Build shared libraries&quot; OFF)</div>
<div class="line"> </div>
<div class="line"># Integration options</div>
<div class="line">option(LOGGER_USE_THREAD_SYSTEM &quot;Integrate with thread_system&quot; ON)</div>
<div class="line">option(BUILD_WITH_COMMON_SYSTEM &quot;Integrate with common_system&quot; ON)</div>
<div class="line">option(LOGGER_STANDALONE_MODE &quot;Build without ecosystem dependencies&quot; OFF)</div>
<div class="line"> </div>
<div class="line"># Testing options</div>
<div class="line">option(LOGGER_BUILD_INTEGRATION_TESTS &quot;Build integration tests&quot; ON)</div>
<div class="line">option(LOGGER_ENABLE_COVERAGE &quot;Enable code coverage reporting&quot; OFF)</div>
<div class="line"> </div>
<div class="line"># Performance options</div>
<div class="line">option(USE_LOCKFREE &quot;Use lock-free data structures (reserved)&quot; OFF)</div>
<div class="line">option(ENABLE_SMALL_STRING_OPTIMIZATION &quot;Enable SSO&quot; ON)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md121"></a>
Dependency Resolution</h2>
<p><b>Priority Order</b> (CMakeLists.txt):</p><ol type="1">
<li>Local path: <code>/Users/dongcheolshin/Sources/common_system/include</code></li>
<li>User home: <code>/home/$USER/Sources/common_system/include</code></li>
<li>GitHub workspace: <code>$ENV{GITHUB_WORKSPACE}/common_system/include</code></li>
<li>Sibling directory: <code>${CMAKE_CURRENT_SOURCE_DIR}/../common_system/include</code></li>
<li>Parent directory: <code>${CMAKE_SOURCE_DIR}/../common_system/include</code></li>
<li>FetchContent from GitHub (fallback)</li>
</ol>
<h2><a class="anchor" id="autotoc_md122"></a>
Compiler Requirements</h2>
<ul>
<li><b>C++ Standard</b>: C++20 required</li>
<li><b>Compilers</b>: GCC 10+, Clang 10+, MSVC 19.29+ (Visual Studio 2019+)</li>
<li><b>Platforms</b>: Windows, Linux, macOS</li>
<li><b>Architectures</b>: x86, x86_64, ARM, ARM64</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md124"></a>
Future Enhancements</h1>
<h2><a class="anchor" id="autotoc_md125"></a>
Planned Features</h2>
<ol type="1">
<li><b>Lock-Free Queue</b>: Replace mutex-based queue with MPSC lock-free queue</li>
<li><b>SIMD Formatting</b>: Vectorized string formatting for high-performance paths</li>
<li><b>Compression</b>: Automatic log compression for rotating files</li>
<li><b>Remote Configuration</b>: Dynamic configuration updates via network</li>
<li><b>Distributed Tracing</b>: OpenTelemetry integration for distributed systems</li>
</ol>
<h2><a class="anchor" id="autotoc_md126"></a>
Research Areas</h2>
<ol type="1">
<li><b>Structured Logging</b>: Enhanced JSON/CBOR support with schema validation</li>
<li><b>Query Interface</b>: SQL-like query language for log analysis</li>
<li><b>Machine Learning</b>: Anomaly detection in log patterns</li>
<li><b>Cloud Integration</b>: Native support for AWS CloudWatch, Google Cloud Logging</li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md128"></a>
Error Code Allocation</h1>
<p>Logger System uses error codes in the range <b>-200 to -299</b>.</p>
<p>Common error codes:</p><ul>
<li><code>-200</code>: Invalid configuration</li>
<li><code>-201</code>: Writer initialization failed</li>
<li><code>-202</code>: File open error</li>
<li><code>-203</code>: Network connection failed</li>
<li><code>-204</code>: Queue overflow</li>
<li><code>-205</code>: Format error</li>
<li><code>-206</code>: Filter error</li>
</ul>
<p>See <code>core/error_codes.h</code> for complete error code listing.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md130"></a>
References</h1>
<ul>
<li><a class="el" href="index.html#md__2home_2runner_2work_2logger__system_2logger__system_2README">README.md</a> - Project overview and quick start</li>
<li><a class="el" href="CHANGELOG_8md.html">CHANGELOG.md</a> - Version history</li>
<li><a class="el" href="md__2home_2runner_2work_2logger__system_2logger__system_2docs_2advanced_2MIGRATION.html">MIGRATION.md</a> - Migration from integrated thread_system</li>
<li><a class="el" href="BASELINE_8md.html">BASELINE.md</a> - Build requirements and baseline</li>
<li><a href="https://github.com/kcenon/common_system">common_system Integration</a></li>
<li><a href="https://github.com/kcenon/thread_system">thread_system Integration</a></li>
<li><a href="https://github.com/kcenon/monitoring_system">monitoring_system Integration</a></li>
</ul>
<hr  />
<p><b>Last Updated:</b> 2025-10-22 <b>Version:</b> 0.1.0.0 <b>Maintainer:</b> <a href="#" onclick="location.href='mai'+'lto:'+'kce'+'no'+'n@n'+'av'+'er.'+'co'+'m'; return false;">kceno<span class="obfuscator">.nosp@m.</span>n@na<span class="obfuscator">.nosp@m.</span>ver.c<span class="obfuscator">.nosp@m.</span>om</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Dec 26 2025 13:38:04 for Logger System by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
